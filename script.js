const slotStructure = {
  TUE: {
    theorySlots: [
      ["TFF1"],
      ["A1"],
      ["B1"],
      ["TC1", "G1"],
      ["D1"],
      ["F2"],
      ["A2"],
      ["B2"],
      ["TC2", "G2"],
      ["TDD2"],
    ],
    theoryTimes: [
      "8.00 - 8.50",
      "9.00 - 9.50",
      "10.00 - 10.50",
      "11.00 - 11.50",
      "12.00 - 12.50",
      "2.00 - 2.50",
      "3.00 - 3.50",
      "4.00 - 4.50",
      "5.00 - 5.50",
      "6.00 - 6.50",
    ],
    labSlots: [
      ["L1"],
      ["L2"],
      ["L3"],
      ["L4"],
      ["L5"],
      ["L6"],
      ["L31"],
      ["L32"],
      ["L33"],
      ["L34"],
      ["L35"],
      ["L36"],
    ],
    labTimes: [
      "8.00 - 8.50",
      "9.00 - 9.50",
      "10.00 - 10.50",
      "11.00 - 11.50",
      "12.00 - 12.50",
      "12.50 - 1.30",
      "2.00 - 2.50",
      "3.00 - 3.50",
      "4.00 - 4.50",
      "5.00 - 5.50",
      "6.00 - 6.50",
      "6.50 - 7.40",
    ],
  },
  WED: {
    theorySlots: [
      ["TGG1"],
      ["D1"],
      ["F1"],
      ["E1", "SC2"],
      ["B1"],
      ["D2"],
      ["TF2", "G2"],
      ["E2", "SC1"],
      ["B2"],
      ["TCC2"],
    ],
    theoryTimes: [
      "8.00 - 8.50",
      "9.00 - 9.50",
      "10.00 - 10.50",
      "11.00 - 11.50",
      "12.00 - 12.50",
      "2.00 - 2.50",
      "3.00 - 3.50",
      "4.00 - 4.50",
      "5.00 - 5.50",
      "6.00 - 6.50",
    ],
    labSlots: [
      ["L7"],
      ["L8"],
      ["L9"],
      ["L10"],
      ["L11"],
      ["L12"],
      ["L37"],
      ["L38"],
      ["L39"],
      ["L40"],
      ["L41"],
      ["L42"],
    ],
    labTimes: [
      "8.00 - 8.50",
      "9.00 - 9.50",
      "10.00 - 10.50",
      "11.00 - 11.50",
      "12.00 - 12.50",
      "12.50 - 1.30",
      "2.00 - 2.50",
      "3.00 - 3.50",
      "4.00 - 4.50",
      "5.00 - 5.50",
      "6.00 - 6.50",
      "6.50 - 7.40",
    ],
  },
  THU: {
    theorySlots: [
      ["TEE1"],
      ["C1"],
      ["TD1", "TG1"],
      ["TAA1", "ECS"],
      ["TBB1", "CLUB"],
      ["TE2", "SE1"],
      ["C2"],
      ["A2"],
      ["TD2", "TG2"],
      ["TGG2"],
    ],
    theoryTimes: [
      "8.00 - 8.50",
      "9.00 - 9.50",
      "10.00 - 10.50",
      "11.00 - 11.50",
      "12.00 - 12.50",
      "2.00 - 2.50",
      "3.00 - 3.50",
      "4.00 - 4.50",
      "5.00 - 5.50",
      "6.00 - 6.50",
    ],
    labSlots: [
      ["L13"],
      ["L14"],
      ["L15"],
      ["L16"],
      ["L17"],
      ["L18"],
      ["L43"],
      ["L44"],
      ["L45"],
      ["L46"],
      ["L47"],
      ["L48"],
    ],
    labTimes: [
      "8.00 - 8.50",
      "9.00 - 9.50",
      "10.00 - 10.50",
      "11.00 - 11.50",
      "12.00 - 12.50",
      "12.50 - 1.30",
      "2.00 - 2.50",
      "3.00 - 3.50",
      "4.00 - 4.50",
      "5.00 - 5.50",
      "6.00 - 6.50",
      "6.50 - 7.40",
    ],
  },
  FRI: {
    theorySlots: [
      ["TCC1"],
      ["TB1"],
      ["TA1"],
      ["F1"],
      ["TE1", "SD2"],
      ["C2"],
      ["TB2"],
      ["TA2"],
      ["F2"],
      ["TEE2"],
    ],
    theoryTimes: [
      "8.00 - 8.50",
      "9.00 - 9.50",
      "10.00 - 10.50",
      "11.00 - 11.50",
      "12.00 - 12.50",
      "2.00 - 2.50",
      "3.00 - 3.50",
      "4.00 - 4.50",
      "5.00 - 5.50",
      "6.00 - 6.50",
    ],
    labSlots: [
      ["L19"],
      ["L20"],
      ["L21"],
      ["L22"],
      ["L23"],
      ["L24"],
      ["L49"],
      ["L50"],
      ["L51"],
      ["L52"],
      ["L53"],
      ["L54"],
    ],
    labTimes: [
      "8.00 - 8.50",
      "9.00 - 9.50",
      "10.00 - 10.50",
      "11.00 - 11.50",
      "12.00 - 12.50",
      "12.50 - 1.30",
      "2.00 - 2.50",
      "3.00 - 3.50",
      "4.00 - 4.50",
      "5.00 - 5.50",
      "6.00 - 6.50",
      "6.50 - 7.40",
    ],
  },
  SAT: {
    theorySlots: [
      ["TDD1"],
      ["E1", "SE2"],
      ["C1"],
      ["TF1", "G1"],
      ["A1"],
      ["D2"],
      ["E2", "SD1"],
      ["TAA2", "ECS"],
      ["TBB2", "CLUB"],
      ["TFF2"],
    ],
    theoryTimes: [
      "8.00 - 8.50",
      "9.00 - 9.50",
      "10.00 - 10.50",
      "11.00 - 11.50",
      "12.00 - 12.50",
      "2.00 - 2.50",
      "3.00 - 3.50",
      "4.00 - 4.50",
      "5.00 - 5.50",
      "6.00 - 6.50",
    ],
    labSlots: [
      ["L25"],
      ["L26"],
      ["L27"],
      ["L28"],
      ["L29"],
      ["L30"],
      ["L55"],
      ["L56"],
      ["L57"],
      ["L58"],
      ["L59"],
      ["L60"],
    ],
    labTimes: [
      "8.00 - 8.50",
      "9.00 - 9.50",
      "10.00 - 10.50",
      "11.00 - 11.50",
      "12.00 - 12.50",
      "12.50 - 1.30",
      "2.00 - 2.50",
      "3.00 - 3.50",
      "4.00 - 4.50",
      "5.00 - 5.50",
      "6.00 - 6.50",
      "6.50 - 7.40",
    ],
  },
};

// // Time slots
// const theoryTimes = [
//   "8:50", // TFF1
//   "9:50", // A1
//   "10:50", // B1
//   "11:50", // TC1
//   "11:50", // G1
//   "12:50", // D1
//   "", // break
//   "14:50", // F2
//   "15:50", // A2
//   "16:50", // B2
//   "17:50", // TC2
//   "17:50", // G2
//   "18:50", // TDD2
//   "", // break
// ];

// const labTimes = [
//   "8:50",
//   "9:50",
//   "10:50",
//   "11:50",
//   "12:50",
//   "13:30",
//   "14:50",
//   "15:50",
//   "16:50",
//   "17:50",
//   "18:50",
//   "19:30",
// ];
const unifiedTimes = [
  { time: "8.00 - 8.50", labOnly: false },
  { time: "9.00 - 9.50", labOnly: false },
  { time: "10.00 - 10.50", labOnly: false },
  { time: "11.00 - 11.50", labOnly: false },
  { time: "12.00 - 12.50", labOnly: false },
  { time: "12.50 - 1.30", labOnly: true }, // üîí Lab-only slot
  { time: "2.00 - 2.50", labOnly: false },
  { time: "3.00 - 3.50", labOnly: false },
  { time: "4.00 - 4.50", labOnly: false },
  { time: "5.00 - 5.50", labOnly: false },
  { time: "6.00 - 6.50", labOnly: false },
  { time: "6.50 - 7.30", labOnly: true }, // Optional: lab-only
];

// Sample data with more realistic slots
const courseData = {
  CSE1022: {
    name: "Introduction to Programming",
    credits: 3,
    theoryTeachers: [
      { name: "RAVI SANKAR BARPANDA", slots: ["D1"], rating: 4.883 },
      { name: "RAVI SANKAR BARPANDA", slots: ["D2"], rating: 4.883 },
      { name: "Prof.Nagendra Panini Challa", slots: ["C1"], rating: 4.417 },
      { name: "Prof.Eswaraiah Rayachoti", slots: ["F1"], rating: 3.77 },
      { name: "AJITH JUBILSON E", slots: ["F1"], rating: 3.86 },
      { name: "Prof.Syed Khasim", slots: ["F2"], rating: 2.957 },
      { name: "JAGADEESH", slots: ["D1"], rating: 3.323 },
      { name: "Prof.Bharathi V C", slots: ["D1"], rating: 3.487 },
      { name: "Prof.Aravapalli Rama Satish", slots: ["C1"], rating: 2.257 },
      { name: "Prof.Afzal Hussain Shahid", slots: ["F1"], rating: 3.25 },
      { name: "Prof.Karthika Natarajan", slots: ["F2"], rating: 2.307 },
      { name: "ANANTHA HARITHA", slots: ["D1"], rating: "-" },
      { name: "ANANTHA HARITHA", slots: ["D2"], rating: "-" },
      { name: "BATTULA VENKATA SATISH BABU", slots: ["C2"], rating: "-" },
      { name: "DASARI RAJIV KUMAR", slots: ["D2"], rating: "-" },
      { name: "DHULIPALLA NAGAJYOTHI", slots: ["C2"], rating: "-" },
      { name: "INDURTHI SRIKANTH", slots: ["D1"], rating: "-" },
      { name: "INDURTHI SRIKANTH", slots: ["D2"], rating: "-" },
      { name: "KANAKA DURGA", slots: ["C1"], rating: "-" },
      { name: "KANAKA DURGA", slots: ["C2"], rating: "-" },
      { name: "KARNA KRISHNAVENI", slots: ["D1"], rating: "-" },
      { name: "KARNA KRISHNAVENI", slots: ["D2"], rating: "-" },
      { name: "KILLI DURGA BHAVANI", slots: ["F2"], rating: "-" },
      { name: "MADAPATI SRI LAKSHMI", slots: ["C1"], rating: "-" },
      { name: "MADAPATI SRI LAKSHMI", slots: ["C2"], rating: "-" },
      { name: "MUNIPALLI UMA MAHESWARA RAO", slots: ["C1"], rating: "-" },
      { name: "MUNIPALLI UMA MAHESWARA RAO", slots: ["C2"], rating: "-" },
      { name: "MUTTANGI CHANDRA SEKHAR", slots: ["F1"], rating: "-" },
      { name: "MUTTANGI CHANDRA SEKHAR", slots: ["F2"], rating: "-" },
      { name: "NAGA MALLESWARARAO P", slots: ["C2"], rating: "-" },
      { name: "NAGA MALLESWARARAO P", slots: ["D2"], rating: "-" },
      { name: "NAGAEESWARI BODAPATI", slots: ["F1"], rating: "-" },
      { name: "ODNALA SRINIVAS", slots: ["F2"], rating: "-" },
      { name: "P.ADI LAKSHMI", slots: ["C1"], rating: "-" },
      { name: "P.ADI LAKSHMI", slots: ["C2"], rating: "-" },
      { name: "PATAN MUSHIYA KATOON", slots: ["C1"], rating: "-" },
      { name: "Prof.Hari Kishan Kondaveeti", slots: ["F2"], rating: "-" },
      { name: "RANJITH KUMAR BANALA", slots: ["F1"], rating: "-" },
      { name: "SAMBASIVA RAO GUMMA", slots: ["F2"], rating: "-" },
      { name: "SHAIK KHASIM BASHA", slots: ["F1"], rating: "-" },
      { name: "SHAIK NEELOFAR", slots: ["F1"], rating: "-" },
      { name: "SHAIK NEELOFAR", slots: ["F2"], rating: "-" },
      { name: "SHAIK SUFIA", slots: ["C2"], rating: "-" },
      { name: "SUDHEER", slots: ["D1"], rating: "-" },
      { name: "TANUKONDA PADMAJA", slots: ["D1"], rating: "-" },
      { name: "TANUKONDA PADMAJA", slots: ["D2"], rating: "-" },
      { name: "YALLANTI SOWJANYA KUMARI", slots: ["C1"], rating: "-" },
      { name: "YAMINI KODALI", slots: ["D2"], rating: "-" },
    ],
    labTeachers: [
      { name: "RAVI SANKAR BARPANDA", slots: ["L10", "L11"], rating: 4.883 },
      { name: "RAVI SANKAR BARPANDA", slots: ["L26", "L27"], rating: 4.883 },
      { name: "RAVI SANKAR BARPANDA", slots: ["L31", "L32"], rating: 4.883 },
      {
        name: "Prof.Nagendra Panini Challa",
        slots: ["L49", "L50"],
        rating: 4.417,
      },
      { name: "AJITH JUBILSON E", slots: ["L39", "L40"], rating: 3.86 },
      { name: "AJITH JUBILSON E", slots: ["L4", "L5"], rating: 3.86 },
      { name: "AJITH JUBILSON E", slots: ["L33", "L34"], rating: 3.86 },
      { name: "Prof.Bharathi V C", slots: ["L55", "L56"], rating: 3.49 },
      { name: "Prof.Bharathi V C", slots: ["L33", "L34"], rating: 3.49 },
      { name: "Prof.Eswaraiah Rayachoti", slots: ["L49", "L50"], rating: 3.77 },
      { name: "Prof.Prashanth Ragam", slots: ["L26", "L27"], rating: 3.55 },
      { name: "JAGADEESH", slots: ["L14", "L15"], rating: 3.323 },
      { name: "Prof.Syed Khasim", slots: ["L45", "L46"], rating: 2.96 },
      {
        name: "Prof.Aravapalli Rama Satish",
        slots: ["L51", "L52"],
        rating: 2.26,
      },
      {
        name: "Prof.Aravapalli Rama Satish",
        slots: ["L22", "L23"],
        rating: 2.26,
      },
      { name: "BURLA NAGARAJU", slots: ["L39", "L40"], rating: "-" },
      { name: "BURLA NAGARAJU", slots: ["L2", "L3"], rating: "-" },
      { name: "DHULIPALLA NAGAJYOTHI", slots: ["L14", "L15"], rating: "-" },
      { name: "INDURTHI SRIKANTH", slots: ["L2", "L3"], rating: "-" },
      { name: "INDURTHI SRIKANTH", slots: ["L41", "L42"], rating: "-" },
      { name: "JAINABBI BANDA", slots: ["L28", "L29"], rating: "-" },
      { name: "KANAKA DURGA", slots: ["L41", "L42"], rating: "-" },
      { name: "KANAKA DURGA", slots: ["L45", "L46"], rating: "-" },
      { name: "KANAKA DURGA", slots: ["L47", "L48"], rating: "-" },
      { name: "KARNA KRISHNAVENI", slots: ["L51", "L52"], rating: "-" },
      { name: "KARNA KRISHNAVENI", slots: ["L33", "L34"], rating: "-" },
      { name: "MADAPATI SRI LAKSHMI", slots: ["L10", "L11"], rating: "-" },
      { name: "MANNEPULI SRUJANA", slots: ["L4", "L5"], rating: "-" },
      { name: "MANNEPULI SRUJANA", slots: ["L10", "L11"], rating: "-" },
      { name: "MUTTANGI CHANDRA SEKHAR", slots: ["L47", "L48"], rating: "-" },
      { name: "MUTTANGI CHANDRA SEKHAR", slots: ["L35", "L36"], rating: "-" },
      { name: "MUTTANGI CHANDRA SEKHAR", slots: ["L53", "L54"], rating: "-" },
      { name: "NADENLLA RAJAMOHANREDDY", slots: ["L20", "L21"], rating: "-" },
      { name: "NAGA MALLESWARARAO P", slots: ["L41", "L42"], rating: "-" },
      { name: "NAGA MALLESWARARAO P", slots: ["L31", "L32"], rating: "-" },
      { name: "PATAN MUSHIYA KATOON", slots: ["L37", "L38"], rating: "-" },
      {
        name: "Prof.Hari Kishan Kondaveeti",
        slots: ["L22", "L23"],
        rating: "-",
      },
      { name: "Prof.Hari Kishan Kondaveeti", slots: ["L8", "L9"], rating: "-" },
      {
        name: "Prof.Hari Kishan Kondaveeti",
        slots: ["L55", "L56"],
        rating: "-",
      },
      { name: "RAMESH BABU KALATHOTI", slots: ["L35", "L36"], rating: "-" },
      { name: "RANJITH KUMAR BANALA", slots: ["L45", "L46"], rating: "-" },
      { name: "SHAIK KHASIM BASHA", slots: ["L47", "L48"], rating: "-" },
      { name: "SHAIK NEELOFAR", slots: ["L53", "L54"], rating: "-" },
      { name: "SHAIK NEELOFAR", slots: ["L43", "L44"], rating: "-" },
      { name: "SUDHEER", slots: ["L28", "L29"], rating: "-" },
      { name: "TANUKONDA PADMAJA", slots: ["L20", "L21"], rating: "-" },
      { name: "TANUKONDA PADMAJA", slots: ["L39", "L40"], rating: "-" },
      { name: "YALLANTI SOWJANYA KUMARI", slots: ["L20", "L21"], rating: "-" },
      { name: "YALLANTI SOWJANYA KUMARI", slots: ["L43", "L44"], rating: "-" },
      { name: "YALLANTI SOWJANYA KUMARI", slots: ["L2", "L3"], rating: "-" },
      { name: "YARLAGADDA SIVA RESHMA", slots: ["L8", "L9"], rating: "-" },
      { name: "YARLAGADDA SIVA RESHMA", slots: ["L37", "L38"], rating: "-" },
    ],
  },
  CSE2001: {
    name: "Data Structures and Algorithms",
    credits: 4,
    theoryTeachers: [
      { name: "DR ANUPRIYA", slots: ["D1", "TD1"], rating: 3.577 },
      { name: "Prof.Gopikrishnan S", slots: ["F2", "TF2"], rating: 4.247 },
      {
        name: "Prof.Naga Jagadesh Bommagani",
        slots: ["F1", "TF1"],
        rating: 4.6,
      },
      { name: "Prof.Sheela Jayachandran", slots: ["D2", "TD2"], rating: 4.165 },
      { name: "Prof.Sheela Jayachandran", slots: ["D1", "TD1"], rating: 4.165 },
      {
        name: "Prof.Dasari Venkata Lakshmi",
        slots: ["F1", "TF1"],
        rating: 4.147,
      },
      { name: "Prof.Udit Narayana Kar", slots: ["F2", "TFF2"], rating: 3.646 },
      { name: "DEVARAKONDA NAGARAJU", slots: ["C2", "TC2"], rating: 4.0 },
      { name: "ASISH KUMAR DALAI", slots: ["D1", "TD1"], rating: 3.61 },
      { name: "Prof.Sandipan Maiti", slots: ["D2", "TD2"], rating: 3.483 },
      {
        name: "Prof.Radha Mohan Pattanayak",
        slots: ["D2", "TD2"],
        rating: 2.56,
      },
      {
        name: "Prof.Radha Mohan Pattanayak",
        slots: ["D1", "TD1"],
        rating: 2.56,
      },
      { name: "Prof.Vikash Kumar Singh", slots: ["D2", "TD2"], rating: 3.023 },
      {
        name: "Prof.Yamarthi Narasimha Rao",
        slots: ["C1", "TC1"],
        rating: 3.563,
      },
      { name: "NARESH SAMMETA", slots: ["C1", "TCC1"], rating: 2.527 },
      {
        name: "Prof.SOUBHAGYA SANKAR BARPANDA",
        slots: ["F2", "TF2"],
        rating: 3.017,
      },
      {
        name: "Prof.SOUBHAGYA SANKAR BARPANDA",
        slots: ["C1", "TC1"],
        rating: 3.017,
      },
      {
        name: "Prof.Jonnadula Harikiran",
        slots: ["D1", "TDD1"],
        rating: 2.293,
      },
      { name: "Prof.Sachi Nandan Mohanty", slots: ["C1", "TC1"], rating: 1.35 },
      { name: "ADLA PADMA", slots: ["F1", "TF1"], rating: "-" },
      { name: "BALUSA BHANU CHANDER", slots: ["D1", "TDD1"], rating: "-" },
      { name: "BEESETTI VANITHA", slots: ["C2", "TC2"], rating: "-" },
      { name: "BEESETTI VANITHA", slots: ["C1", "TCC1"], rating: "-" },
      { name: "DR. D. SANTHADEVI", slots: ["C1", "TCC1"], rating: "-" },
      { name: "DR. D. SANTHADEVI", slots: ["C2", "TC2"], rating: "-" },
      { name: "DR. DEEPANRAMKUMAR P", slots: ["F2", "TF2"], rating: "-" },
      { name: "DR. DEEPANRAMKUMAR P", slots: ["F1", "TF1"], rating: "-" },
      { name: "HAJARATHAIAH", slots: ["D2", "TDD2"], rating: "-" },
      { name: "HAJARATHAIAH", slots: ["D1", "TD1"], rating: "-" },
      { name: "MANTRAVADI GAYATHRI", slots: ["C2", "TCC2"], rating: "-" },
      { name: "PAMIDI PRAMEELA", slots: ["D2", "TDD2"], rating: "-" },
      { name: "PAMIDI PRAMEELA", slots: ["C2", "TCC2"], rating: "-" },
      { name: "PAMULAPATI ASHOK REDDY", slots: ["D2", "TDD2"], rating: "-" },
      { name: "PRIYANKA SINGH", slots: ["F2", "TF2"], rating: "-" },
      { name: "PRIYANKA SINGH", slots: ["F1", "TF1"], rating: "-" },
      {
        name: "Prof. Azees Maria John Francis",
        slots: ["F1", "TFF1"],
        rating: "-",
      },
      { name: "PUJARI JEEVANA JYOTHI", slots: ["D2", "TD2"], rating: "-" },
      { name: "PUJARI JEEVANA JYOTHI", slots: ["C1", "TCC1"], rating: "-" },
      { name: "S V KISHORE BABU", slots: ["F2", "TFF2"], rating: "-" },
      { name: "S V KISHORE BABU", slots: ["F1", "TFF1"], rating: "-" },
      { name: "SAMUKA MOHANTY", slots: ["F2", "TF2"], rating: "-" },
      { name: "SAMUKA MOHANTY", slots: ["D1", "TDD1"], rating: "-" },
      { name: "SANAL KUMAR T S", slots: ["C2", "TC2"], rating: "-" },
      { name: "SANAL KUMAR T S", slots: ["C1", "TC1"], rating: "-" },
      { name: "SHAIK MAHABOOB BASHA", slots: ["C2", "TC2"], rating: "-" },
      { name: "SHAIK MAHABOOB BASHA", slots: ["F1", "TFF1"], rating: "-" },
      { name: "SUBBA RAO DUSARI", slots: ["F2", "TFF2"], rating: "-" },
      { name: "SUBBA RAO DUSARI", slots: ["C2", "TCC2"], rating: "-" },
    ],
    labTeachers: [
      {
        name: "Prof.Naga Jagadesh Bommagani",
        slots: ["L43", "L44"],
        rating: 4.61,
      },
      { name: "Prof.Sheela Jayachandran", slots: ["L39", "L40"], rating: 4.22 },
      { name: "Prof.Sheela Jayachandran", slots: ["L20", "L21"], rating: 4.22 },
      { name: "Prof.Reeja S R", slots: ["L26", "L27"], rating: 4.07 },
      {
        name: "Prof.Dasari Venkata Lakshmi",
        slots: ["L55", "L56"],
        rating: 4.15,
      },
      {
        name: "Prof.Dasari Venkata Lakshmi",
        slots: ["L39", "L40"],
        rating: 4.15,
      },
      { name: "Prof.Udit Narayana Kar", slots: ["L22", "L23"], rating: 3.65 },
      { name: "Prof.Udit Narayana Kar", slots: ["L2", "L3"], rating: 3.65 },
      { name: "DEVARAKONDA NAGARAJU", slots: ["L26", "L27"], rating: 4.0 },
      {
        name: "Prof.Radha Mohan Pattanayak",
        slots: ["L31", "L32"],
        rating: 2.56,
      },
      {
        name: "Prof.Yamarthi Narasimha Rao",
        slots: ["L51", "L52"],
        rating: 3.58,
      },
      {
        name: "Prof.Yamarthi Narasimha Rao",
        slots: ["L37", "L38"],
        rating: 3.58,
      },
      { name: "Prof.Vikash Kumar Singh", slots: ["L43", "L44"], rating: 3.02 },
      {
        name: "Prof.SOUBHAGYA SANKAR BARPANDA",
        slots: ["L28", "L29"],
        rating: 3.02,
      },
      {
        name: "Prof.SOUBHAGYA SANKAR BARPANDA",
        slots: ["L45", "L46"],
        rating: 3.02,
      },
      { name: "Prof.Jonnadula Harikiran", slots: ["L49", "L50"], rating: 2.29 },
      {
        name: "Prof.Sachi Nandan Mohanty",
        slots: ["L45", "L46"],
        rating: 1.35,
      },
      {
        name: "Prof.Sachi Nandan Mohanty",
        slots: ["L31", "L32"],
        rating: 1.35,
      },
      { name: "SUBBA RAO DUSARI", slots: ["L14", "L15"], rating: "-" },
      { name: "SUBBA RAO DUSARI", slots: ["L10", "L11"], rating: "-" },
      { name: "SHAIK NEELOFAR", slots: ["L49", "L50"], rating: "-" },
      { name: "SHAIK MAHABOOB BASHA", slots: ["L28", "L29"], rating: "-" },
      { name: "SHAIK MAHABOOB BASHA", slots: ["L53", "L54"], rating: "-" },
      { name: "SANAL KUMAR T S", slots: ["L10", "L11"], rating: "-" },
      { name: "SAMUKA MOHANTY", slots: ["L14", "L15"], rating: "-" },
      { name: "S V KISHORE BABU", slots: ["L20", "L21"], rating: "-" },
      { name: "S V KISHORE BABU", slots: ["L43", "L44"], rating: "-" },
      { name: "PUJARI JEEVANA JYOTHI", slots: ["L4", "L5"], rating: "-" },
      {
        name: "Prof.SCOPE Dig Crs Faculty-3",
        slots: ["L35", "L36"],
        rating: "-",
      },
      {
        name: "Prof.SCOPE Dig Crs Faculty-2",
        slots: ["L41", "L42"],
        rating: "-",
      },
      {
        name: "Prof.SCOPE Dig Crs Faculty-2",
        slots: ["L53", "L54"],
        rating: "-",
      },
      {
        name: "Prof.SCOPE Dig Crs Faculty-2",
        slots: ["L47", "L48"],
        rating: "-",
      },
      {
        name: "Prof.SCOPE Dig Crs Faculty-2",
        slots: ["L35", "L36"],
        rating: "-",
      },
      {
        name: "Prof.SCOPE Dig Crs Faculty-1",
        slots: ["L35", "L36"],
        rating: "-",
      },
      {
        name: "Prof.SCOPE Dig Crs Faculty-1",
        slots: ["L37", "L38"],
        rating: "-",
      },
      { name: "PRIYANKA SINGH", slots: ["L26", "L27"], rating: "-" },
      { name: "PRIYANKA SINGH", slots: ["L33", "L34"], rating: "-" },
      { name: "PAMULAPATI ASHOK REDDY", slots: ["L33", "L34"], rating: "-" },
      { name: "PAMULAPATI ASHOK REDDY", slots: ["L8", "L9"], rating: "-" },
      { name: "PAMIDI PRAMEELA", slots: ["L22", "L23"], rating: "-" },
      { name: "PAMIDI PRAMEELA", slots: ["L31", "L32"], rating: "-" },
      { name: "MANTRAVADI GAYATHRI", slots: ["L55", "L56"], rating: "-" },
      { name: "KARNA KRISHNAVENI", slots: ["L20", "L21"], rating: "-" },
      { name: "INDURTHI SRIKANTH", slots: ["L53", "L54"], rating: "-" },
      { name: "DR. DEEPANRAMKUMAR P", slots: ["L41", "L42"], rating: "-" },
      { name: "DR. DEEPANRAMKUMAR P", slots: ["L55", "L56"], rating: "-" },
      { name: "DR. D. SANTHADEVI", slots: ["L51", "L52"], rating: "-" },
      { name: "DR. D. SANTHADEVI", slots: ["L2", "L3"], rating: "-" },
      { name: "BEESETTI VANITHA", slots: ["L4", "L5"], rating: "-" },
      { name: "BEESETTI VANITHA", slots: ["L8", "L9"], rating: "-" },
      { name: "BALUSA BHANU CHANDER", slots: ["L28", "L29"], rating: "-" },
      { name: "BALUSA BHANU CHANDER", slots: ["L47", "L48"], rating: "-" },
    ],
  },
  CSE3002: {
    name: "Artificial Intelligence",
    credits: 3,
    theoryTeachers: [
      {
        name: "Prof.Siddique Ibrahim Peer Mohamed",
        slots: ["E2", "TE2"],
        rating: 3.93,
      },
      { name: "Prof.Rajesh Duvvuru", slots: ["E1", "TE1"], rating: 4.2 },
      { name: "Prof.Rajesh Duvvuru", slots: ["E2", "TE2"], rating: 4.2 },
      { name: "AJITH JUBILSON E", slots: ["A1", "TA1"], rating: 4.45 },
      { name: "AJITH JUBILSON E", slots: ["A2", "TA2"], rating: 4.45 },
      { name: "Prof.Monali Bordoloi", slots: ["G1", "TG1"], rating: 3.82 },
      { name: "Prof.Prashanth Ragam", slots: ["A1", "TA1"], rating: 3.27 },
      { name: "Prof.Prashanth Ragam", slots: ["A2", "TA2"], rating: 3.27 },
      { name: "BALUSA BHANU CHANDER", slots: ["E1", "TE1"], rating: "-" },
      { name: "BALUSA BHANU CHANDER", slots: ["E2", "TE2"], rating: "-" },
      { name: "BURLA NAGARAJU", slots: ["G1", "TG1"], rating: "-" },
      { name: "BURLA NAGARAJU", slots: ["G2", "TG2"], rating: "-" },
      { name: "DR. HELEN SHARMILA A", slots: ["A2", "TA2"], rating: "-" },
      { name: "DR. SURESH DARA", slots: ["A2", "TA2"], rating: "-" },
      { name: "EDARA SREENIVASA REDDY", slots: ["A1", "TA1"], rating: "-" },
      { name: "MANNEPULI SRUJANA", slots: ["G2", "TG2"], rating: "-" },
      { name: "MANNEPULI SRUJANA", slots: ["A1", "TA1"], rating: "-" },
      { name: "NADENLLA RAJAMOHANREDDY", slots: ["E2", "TEE2"], rating: "-" },
      { name: "NADENLLA RAJAMOHANREDDY", slots: ["E1", "TEE1"], rating: "-" },
      { name: "NAGAEESWARI BODAPATI", slots: ["A1", "TA1"], rating: "-" },
      { name: "PAMULAPATI ASHOK REDDY", slots: ["E1", "TE1"], rating: "-" },
      { name: "PAMULAPATI ASHOK REDDY", slots: ["E2", "TE2"], rating: "-" },
      {
        name: "Prof.Hari Kishan Kondaveeti",
        slots: ["A1", "TA1"],
        rating: "-",
      },
      {
        name: "Prof.Hari Kishan Kondaveeti",
        slots: ["A2", "TA2"],
        rating: "-",
      },
      {
        name: "Prof.Mukkoti Maruthi Venkata Chalapathi",
        slots: ["E1", "TEE1"],
        rating: "-",
      },
      { name: "RAMESH BABU KALATHOTI", slots: ["E2", "TEE2"], rating: "-" },
      { name: "RAMESH BABU KALATHOTI", slots: ["E1", "TE1"], rating: "-" },
      { name: "YALLANTI SOWJANYA KUMARI", slots: ["G2", "TG2"], rating: "-" },
      { name: "YALLANTI SOWJANYA KUMARI", slots: ["G1", "TG1"], rating: "-" },
      { name: "YARLAGADDA SIVA RESHMA", slots: ["A1", "TA1"], rating: "-" },
      { name: "YARLAGADDA SIVA RESHMA", slots: ["A2", "TA2"], rating: "-" },
    ],
  },
  MAT1003: {
    name: "Discrete Mathematical Structures",
    credits: 4,
    theoryTeachers: [
      { name: "Prof.Soumen Kundu", slots: ["B1", "TB1", "TBB1"], rating: 4.89 },
      { name: "Prof.Piu Kundu", slots: ["B2", "TB2", "TBB2"], rating: 4.07 },
      {
        name: "Prof.Peeyush Singh",
        slots: ["B2", "TB2", "TBB2"],
        rating: 4.205,
      },
      { name: "Prof.Francis P", slots: ["A2", "TA2", "TAA2"], rating: 4.06 },
      { name: "Prof.Francis P", slots: ["B1", "TB1", "TBB1"], rating: 4.06 },
      {
        name: "Prof.Santunu Mandal",
        slots: ["B1", "TB1", "TBB1"],
        rating: 4.07,
      },
      {
        name: "Prof.Santunu Mandal",
        slots: ["B2", "TB2", "TBB2"],
        rating: 4.07,
      },
      { name: "DR.NIMAI SARKAR", slots: ["E1", "TE1", "TEE1"], rating: 3.96 },
      {
        name: "Prof.Pratik Premadarshi Ray",
        slots: ["B1", "TB1", "TBB1"],
        rating: 3.54,
      },
      {
        name: "Prof.Pratik Premadarshi Ray",
        slots: ["B2", "TB2", "TBB2"],
        rating: 3.54,
      },
      {
        name: "Prof.Shalini Thakur",
        slots: ["A1", "TA1", "TAA1"],
        rating: 3.23,
      },
      {
        name: "Prof.Shalini Thakur",
        slots: ["B1", "TB1", "TBB1"],
        rating: 3.23,
      },
      { name: "Prof.V.Raja", slots: ["A1", "TA1", "TAA1"], rating: 3.04 },
      { name: "Prof.V.Raja", slots: ["A2", "TA2", "TAA2"], rating: 3.04 },
      {
        name: "Prof.Davala Ravi Kumar",
        slots: ["A2", "TA2", "TAA2"],
        rating: 3.77,
      },
      { name: "Prof.Manisha Maity", slots: ["B1", "TB1", "TBB1"], rating: 3.6 },
      { name: "Prof.Manisha Maity", slots: ["B2", "TB2", "TBB2"], rating: 3.6 },
      {
        name: "DR.VANACHARLA PUJITHA",
        slots: ["A1", "TA1", "TAA1"],
        rating: 3.19,
      },
      {
        name: "Prof.Chandan Kumar Thakur",
        slots: ["A2", "TA2", "TAA2"],
        rating: 2.48,
      },
      { name: "DR.PRASHANT PATEL", slots: ["A2", "TA2", "TAA2"], rating: 2.52 },
      { name: "DR.PRASHANT PATEL", slots: ["E1", "TE1", "TEE1"], rating: 2.52 },
      {
        name: "Prof.Prashanth Maroju",
        slots: ["B2", "TB2", "TBB2"],
        rating: 2.6,
      },
      {
        name: "Prof.Venkatarajam M",
        slots: ["A1", "TA1", "TAA1"],
        rating: 2.66,
      },
      { name: "DR.SANTANU NANDI", slots: ["A1", "TA1", "TAA1"], rating: 1.96 },
      {
        name: "Prof.Arun Kumar Yadav",
        slots: ["E1", "TE1", "TEE1"],
        rating: 1.88,
      },
      {
        name: "Prof.Arun Kumar Yadav",
        slots: ["E2", "TE2", "TEE2"],
        rating: 1.88,
      },
      {
        name: "SHOBHIT KUMAR SRIVASTAVA",
        slots: ["E1", "TE1", "TEE1"],
        rating: 1.67,
      },
      {
        name: "SHOBHIT KUMAR SRIVASTAVA",
        slots: ["E2", "TE2", "TEE2"],
        rating: 1.67,
      },
      {
        name: "AMRENDRA SINGH GILL",
        slots: ["E2", "TE2", "TEE2"],
        rating: "-",
      },
      {
        name: "Dr Pradip Ramesh Patle",
        slots: ["A1", "TA1", "TAA1"],
        rating: "-",
      },
      {
        name: "Dr Pradip Ramesh Patle",
        slots: ["E2", "TE2", "TEE2"],
        rating: "-",
      },
      { name: "DR. GOKULNATH M", slots: ["E2", "TE2", "TEE2"], rating: "-" },
      {
        name: "Prof.Perumandla Karunakar",
        slots: ["B1", "TB1", "TBB1"],
        rating: "-",
      },
      {
        name: "Prof.Rajashekar Naraveni",
        slots: ["B2", "TB2", "TBB2"],
        rating: "-",
      },
      {
        name: "Prof.Sudhakar Matle",
        slots: ["A1", "TA1", "TAA1"],
        rating: "-",
      },
      {
        name: "Prof.Sudhakar Matle",
        slots: ["A2", "TA2", "TAA2"],
        rating: "-",
      },
      { name: "S V GOMATHI", slots: ["A2", "TA2", "TAA2"], rating: "-" },
      { name: "S V GOMATHI", slots: ["E1", "TE1", "TEE1"], rating: "-" },
      { name: "SATPAL SINGH", slots: ["E1", "TE1", "TEE1"], rating: "-" },
      { name: "SATPAL SINGH", slots: ["E2", "TE2", "TEE2"], rating: "-" },
      { name: "SHAZIA SABIR", slots: ["E1", "TE1", "TEE1"], rating: "-" },
      { name: "SHAZIA SABIR", slots: ["E2", "TE2", "TEE2"], rating: "-" },
    ],
  },
  MGT1001: {
    name: "Ethics and Values - Lab Only",
    credits: 2,
    theoryTeachers: [
      { name: "DR.SUNIL KHOSLA", slots: ["L26", "L27"], rating: 4.44 },
      { name: "DR.SUNIL KHOSLA", slots: ["L4", "L5"], rating: 4.44 },
      { name: "K. DEEPANJAN", slots: ["L43", "L44"], rating: 4.67 },
      { name: "Prof.Suresh Jagannadham", slots: ["L33", "L34"], rating: 4.49 },
      { name: "Prof.Suresh Jagannadham", slots: ["L39", "L40"], rating: 4.49 },
      { name: "Prof.Suresh Jagannadham", slots: ["L35", "L36"], rating: 4.49 },
      { name: "Prof.Suresh Jagannadham", slots: ["L49", "L50"], rating: 4.49 },
      { name: "Prof.Chandan Vishwas", slots: ["L39", "L40"], rating: 4.14 },
      { name: "Prof.Joseph Alugula", slots: ["L14", "L15"], rating: 4.18 },
      { name: "AMRITA PURAKAYASTHA", slots: ["L45", "L46"], rating: 4.0 },
      { name: "ASHRAF PULIKKAMATH", slots: ["L37", "L38"], rating: 3.19 },
      { name: "Prof.Sanjit Chakraborty", slots: ["L33", "L34"], rating: 2.84 },
      { name: "Prof.Sanjit Chakraborty", slots: ["L53", "L54"], rating: 2.84 },
      { name: "Prof.Sanjit Chakraborty", slots: ["L8", "L9"], rating: 2.84 },
      { name: "Prof.Sanjit Chakraborty", slots: ["L31", "L32"], rating: 2.84 },
      { name: "ANINDITA ROY", slots: ["L47", "L48"], rating: "-" },
      { name: "ANINDITA ROY", slots: ["L41", "L42"], rating: "-" },
      { name: "DR ASWATHY M", slots: ["L14", "L15"], rating: "-" },
      { name: "DR. TANMOY DAS", slots: ["L51", "L52"], rating: "-" },
      { name: "GAURAV SONIK", slots: ["L55", "L56"], rating: "-" },
      { name: "GAURAV SONIK", slots: ["L2", "L3"], rating: "-" },
      { name: "GAURAV SONIK", slots: ["L10", "L11"], rating: "-" },
      { name: "K KINJARI", slots: ["L53", "L54"], rating: "-" },
      { name: "KRISHNA NAIR J", slots: ["L49", "L50"], rating: "-" },
      { name: "KRISHNA NAIR J", slots: ["L4", "L5"], rating: "-" },
      { name: "KRISHNA NAIR J", slots: ["L47", "L48"], rating: "-" },
      { name: "NEHA KUMARI", slots: ["L20", "L21"], rating: "-" },
      { name: "NEHA KUMARI", slots: ["L43", "L44"], rating: "-" },
      {
        name: "Prof.Pottumuthu Kanaka Himabindu",
        slots: ["L22", "L23"],
        rating: "-",
      },
      {
        name: "Prof.Renuprasad Hemkiran Patki",
        slots: ["L55", "L56"],
        rating: "-",
      },
      { name: "SAJAD NABI DAR", slots: ["L26", "L27"], rating: "-" },
      { name: "SAJAD NABI DAR", slots: ["L41", "L42"], rating: "-" },
      { name: "SAJAD NABI DAR", slots: ["L28", "L29"], rating: "-" },
      { name: "SOUMIK SARKAR", slots: ["L22", "L23"], rating: "-" },
    ],
  },
  MGT1040: {
    name: "Entrepreneurship - Theory Only",
    credits: 2,
    theoryTeachers: [
      { name: "Prof.Deepjoy Katuwal", slots: ["D2"], rating: 4.86 },
      { name: "Prof.Karishma Bisht", slots: ["E2"], rating: 4.05 },
      { name: "Prof.Karishma Bisht", slots: ["D1"], rating: 4.05 },
      { name: "Prof.Aby Abraham", slots: ["E1"], rating: 3.87 },
      { name: "Prof.Aby Abraham", slots: ["D2"], rating: 3.87 },
      { name: "DR. SHAIKU SHAHIDA SAHEB", slots: ["G1"], rating: 3.77 },
      { name: "DR. SHAIKU SHAHIDA SAHEB", slots: ["G2"], rating: 3.77 },
      { name: "DR.KASHIF BEG", slots: ["G1"], rating: 2.4 },
      { name: "DRIPTA DE JOARDER", slots: ["E2"], rating: 2.42 },
      { name: "DRIPTA DE JOARDER", slots: ["D1"], rating: 2.42 },
      { name: "PALAGANI VIJAYA BHASKARA REDDY", slots: ["G2"], rating: "-" },
      { name: "PALAGANI VIJAYA BHASKARA REDDY", slots: ["D2"], rating: "-" },
      { name: "PALAGANI VIJAYA BHASKARA REDDY", slots: ["D1"], rating: "-" },
      { name: "DR.UMER MUSHTAQ LONE", slots: ["G1"], rating: "-" },
      { name: "DR.UMER MUSHTAQ LONE", slots: ["D1"], rating: "-" },
      { name: "DR.N.PRABHAKAR", slots: ["E2"], rating: "-" },
      { name: "DR.N.PRABHAKAR", slots: ["E1"], rating: "-" },
      { name: "DR.G.SOMA SEKHAR", slots: ["G2"], rating: "-" },
      { name: "DR.G.SOMA SEKHAR", slots: ["G1"], rating: "-" },
      { name: "DR. SENTHAMIZHSELVI.A", slots: ["G2"], rating: "-" },
      { name: "DR. SENTHAMIZHSELVI.A", slots: ["E1"], rating: "-" },
      { name: "DR. SENTHAMIZHSELVI.A", slots: ["E2"], rating: "-" },
      { name: "DR. RAJASHREE NAIK", slots: ["D2"], rating: "-" },
      { name: "DR. RAJASHREE NAIK", slots: ["E1"], rating: "-" },
    ],
  },
  STS2008: {
    name: "Numeric ability and Cognitive Intelligence",
    credits: 3,
    theoryTeachers: [
      { name: "SUPRIYA C", slots: ["A1", "TA1"], rating: "-" },
      { name: "Prof.Sheik Noushad", slots: ["A1", "TA1"], rating: "-" },
      { name: "Prof. Sudharshan", slots: ["A1", "TA1"], rating: "-" },
      { name: "Mamatha", slots: ["A1", "TA1"], rating: "-" },
      { name: "SUPRIYA C", slots: ["A2", "TA2"], rating: "-" },
      { name: "Prof.Yamini Durga", slots: ["A2", "TA2"], rating: "-" },
      { name: "Prof.Sheik Noushad", slots: ["A2", "TA2"], rating: "-" },
      { name: "Prof. Sudharshan", slots: ["A2", "TA2"], rating: "-" },
      { name: "LIKITHA", slots: ["A2", "TA2"], rating: "-" },
      { name: "Prof.Vijay", slots: ["B1", "TB1"], rating: "-" },
      { name: "Prof.Divya Bora", slots: ["B1", "TB1"], rating: "-" },
      { name: "LIKITHA", slots: ["B1", "TB1"], rating: "-" },
      { name: "KALYANI M", slots: ["B1", "TB1"], rating: "-" },
      { name: "Prof.Sheik Noushad", slots: ["B2", "TB2"], rating: "-" },
      { name: "Prof.Divya Bora", slots: ["B2", "TB2"], rating: "-" },
      { name: "Prof. Jesmitha", slots: ["B2", "TB2"], rating: "-" },
      { name: "BHARATHWAJ", slots: ["B2", "TB2"], rating: "-" },
      { name: "Prof.Sheik Noushad", slots: ["C1", "TC1"], rating: "-" },
      { name: "BHARATHWAJ", slots: ["C1", "TC1"], rating: "-" },
      { name: "SUPRIYA C", slots: ["C1", "TCC1"], rating: "-" },
      { name: "Jayesh", slots: ["C1", "TCC1"], rating: "-" },
      { name: "SUPRIYA C", slots: ["C2", "TC2"], rating: "-" },
      { name: "KALYANI M", slots: ["C2", "TC2"], rating: "-" },
      { name: "Prof.Vijay", slots: ["C2", "TCC2"], rating: "-" },
      { name: "Jayesh", slots: ["C2", "TCC2"], rating: "-" },
      { name: "Prof. Jesmitha", slots: ["D1", "TD1"], rating: "-" },
      { name: "KALYANI M", slots: ["D1", "TD1"], rating: "-" },
      { name: "Prof.Divya Bora", slots: ["D1", "TDD1"], rating: "-" },
      { name: "LIKITHA", slots: ["D1", "TDD1"], rating: "-" },
      { name: "Prof.Sheik Noushad", slots: ["D2", "TD2"], rating: "-" },
      { name: "BHARATHWAJ", slots: ["D2", "TD2"], rating: "-" },
      { name: "Prof.Vijay", slots: ["D2", "TDD2"], rating: "-" },
      { name: "Mamatha", slots: ["D2", "TDD2"], rating: "-" },
      { name: "Prof.Yamini Durga", slots: ["E1", "TE1"], rating: "-" },
      { name: "Prof. Jesmitha", slots: ["E1", "TE1"], rating: "-" },
      { name: "Mamatha", slots: ["E1", "TE1"], rating: "-" },
      { name: "LIKITHA", slots: ["E1", "TE1"], rating: "-" },
      { name: "BHARATHWAJ", slots: ["E1", "TE1"], rating: "-" },
      { name: "SUPRIYA C", slots: ["E2", "TE2"], rating: "-" },
      { name: "Prof.Sheik Noushad", slots: ["E2", "TE2"], rating: "-" },
      { name: "Prof.Divya Bora", slots: ["E2", "TE2"], rating: "-" },
      { name: "Prof. Jesmitha", slots: ["E2", "TE2"], rating: "-" },
      { name: "KALYANI M", slots: ["E2", "TE2"], rating: "-" },
      { name: "Prof. Jesmitha", slots: ["F1", "TF1"], rating: "-" },
      { name: "Mamatha", slots: ["F1", "TF1"], rating: "-" },
      { name: "Prof.Divya Bora", slots: ["F1", "TFF1"], rating: "-" },
      { name: "LIKITHA", slots: ["F1", "TFF1"], rating: "-" },
      { name: "SUPRIYA C", slots: ["F2", "TF2"], rating: "-" },
      { name: "BHARATHWAJ", slots: ["F2", "TF2"], rating: "-" },
      { name: "Prof.Vijay", slots: ["F2", "TFF2"], rating: "-" },
      { name: "LIKITHA", slots: ["F2", "TFF2"], rating: "-" },
      { name: "KALYANI M", slots: ["F2", "TFF2"], rating: "-" },
      { name: "Prof.Yamini Durga", slots: ["G1", "TG1"], rating: "-" },
      { name: "Prof.Vijay", slots: ["G1", "TG1"], rating: "-" },
      { name: "Prof.Divya Bora", slots: ["G2", "TG2"], rating: "-" },
      { name: "Prof. Jesmitha", slots: ["G2", "TG2"], rating: "-" },
    ],
  },
};

// DOM Elements
const courseSelect = document.getElementById("course-type");
const confirmBtn = document.getElementById("confirm-courses");
const backBtn = document.getElementById("back-to-courses");
const saveBtn = document.getElementById("save-selection");
const loadBtn = document.getElementById("load-selection");
const teacherSection = document.getElementById("teacher-selection");
const teacherContainer = document.getElementById("teacher-options-container");
const generateBtn = document.getElementById("generate-timetable");
const resetBtn = document.getElementById("reset-selection");
const timetableDisplay = document.getElementById("timetable-display");
const timetableGrid = document.getElementById("timetable-grid");
const exportPdfBtn = document.getElementById("export-pdf");
const exportImageBtn = document.getElementById("export-image");
const conflictWarnings = document.getElementById("conflict-warnings");

const selections = {
  courses: [],
  teachers: {},
  version: "2.0.0",
};

// ‚úÖ Initialize timetable grid
function initializeTimetable() {
  timetableGrid.innerHTML = "";

  const days = ["TUE", "WED", "THU", "FRI", "SAT"];

  // First row: Header
  const timeHeader = document.createElement("div");
  timeHeader.className = "timetable-cell day-header";
  timeHeader.textContent = "Time";
  timetableGrid.appendChild(timeHeader);

  days.forEach((day) => {
    const dayHeader = document.createElement("div");
    dayHeader.className = "timetable-cell day-header";
    dayHeader.textContent = day;
    timetableGrid.appendChild(dayHeader);
  });

  // Time rows
  // Track separate index for theory slot rows
  const theoryIndices = {
    TUE: 0,
    WED: 0,
    THU: 0,
    FRI: 0,
    SAT: 0,
  };

  unifiedTimes.forEach((timeObj, timeIndex) => {
    // Time column
    const timeCell = document.createElement("div");
    timeCell.className = "timetable-cell time-header";
    timeCell.textContent = timeObj.time;
    if (timeObj.labOnly) timeCell.classList.add("lab-only-time");
    timetableGrid.appendChild(timeCell);

    // For each day
    days.forEach((day) => {
      const cell = document.createElement("div");
      cell.className = "timetable-cell";

      let theorySlots = [];
      if (!timeObj.labOnly) {
        // Only use theory slot if it's a theory-compatible time
        theorySlots =
          slotStructure[day]?.theorySlots?.[theoryIndices[day]] || [];
        theoryIndices[day]++; // only increment if we actually used it
      }

      const labSlots = slotStructure[day]?.labSlots?.[timeIndex] || [];

      const allSlots = [...theorySlots, ...labSlots].flat();

      if (allSlots.length > 0) {
        const label = document.createElement("div");
        label.className = "slot-code-label";
        label.textContent = allSlots.join(" / ");
        cell.appendChild(label);
      }

      timetableGrid.appendChild(cell);
    });
  });
}

function sameSlots(a, b) {
  if (!a || !b) return false;
  return (
    a.length === b.length && a.every((val, i) => val.trim() === b[i].trim())
  );
}

// ‚úÖ Show teacher options for each course
function showTeacherOptions() {
  const selectedOptions = Array.from(courseSelect.selectedOptions);

  // Preserve old selections and just add new ones
  selectedOptions.forEach((opt) => {
    const courseCode = opt.value.split(" - ")[0];
    if (!selections.courses.includes(courseCode)) {
      selections.courses.push(courseCode);
    }
  });

  if (selections.courses.length === 0) {
    alert("Please select at least one course.");
    return;
  }

  teacherContainer.innerHTML = "";

  const currentSelection = selectedOptions.map(
    (opt) => opt.value.split(" - ")[0]
  );

  currentSelection.forEach((courseCode) => {
    const course = courseData[courseCode];
    if (!course) return;

    const courseDiv = document.createElement("div");
    courseDiv.className = "course-section card";
    courseDiv.innerHTML = `
      <h3>${courseCode}: ${course.name} (${course.credits} Credits)</h3>
      <div class="teacher-section">
        <div class="teacher-type-label">Theory Teachers</div>
        <div class="teachers-grid" id="theory-${courseCode}"></div>
      </div>
      <div class="teacher-section">
        <div class="teacher-type-label">Lab Teachers</div>
        <div class="teachers-grid" id="lab-${courseCode}"></div>
      </div>
    `;
    teacherContainer.appendChild(courseDiv);

    const theoryContainer = document.getElementById(`theory-${courseCode}`);
    const labContainer = document.getElementById(`lab-${courseCode}`);

    // Helper to render teachers for theory/lab
    function renderTeacherOptions(container, type, teacherList) {
      const groupName = `${courseCode}-${type}`;
      const selected = selections.teachers[courseCode]?.[type];

      // No Preference option
      const noPrefId = `${groupName}-no-preference`;
      const noPrefSelected = !selected;
      const noPrefDiv = document.createElement("div");
      noPrefDiv.className = "teacher-card";
      noPrefDiv.innerHTML = `
        <input type="radio" name="${groupName}" id="${noPrefId}" value="" hidden ${
        noPrefSelected ? "checked" : ""
      }>
        <label class="card-ui ${
          noPrefSelected ? "selected" : ""
        }" for="${noPrefId}">
          <div class="teacher-name">No Preference</div>
          <div class="teacher-meta"><span class="rating">System will choose</span><span class="slots">Any slot</span></div>
        </label>
      `;
      container.appendChild(noPrefDiv);

      document.getElementById(noPrefId).addEventListener("change", () => {
        if (!selections.teachers[courseCode])
          selections.teachers[courseCode] = {};
        delete selections.teachers[courseCode][type];

        document
          .querySelectorAll(`input[name="${groupName}"]`)
          .forEach((input) => {
            input.nextElementSibling.classList.toggle(
              "selected",
              input.checked
            );
          });
      });

      // Real teachers
      teacherList.forEach((teacher) => {
        const key = `${groupName}-${teacher.name.replace(
          /\s+/g,
          "-"
        )}-${Math.random().toString(36).substr(2, 4)}`;
        const isSelected =
          selected?.name === teacher.name &&
          sameSlots(selected?.slots, teacher.slots);

        const div = document.createElement("div");
        div.className = "teacher-card";
        div.innerHTML = `
          <input type="radio" name="${groupName}" id="${key}" value="${
          teacher.name
        }" data-slots="${teacher.slots.join(",")}" hidden ${
          isSelected ? "checked" : ""
        }>
          <label class="card-ui ${isSelected ? "selected" : ""}" for="${key}">
            <div class="teacher-name">${teacher.name}</div>
            <div class="teacher-meta">
              <span class="rating">${
                teacher.rating ? "‚≠ê " + teacher.rating : "No rating"
              }</span>
              <span class="slots">${teacher.slots.join(", ")}</span>
            </div>
          </label>
        `;
        container.appendChild(div);

        document.getElementById(key).addEventListener("change", (e) => {
          if (!selections.teachers[courseCode])
            selections.teachers[courseCode] = {};
          selections.teachers[courseCode][type] = {
            name: e.target.value,
            slots: e.target.dataset.slots.split(",").map((s) => s.trim()),
          };

          document
            .querySelectorAll(`input[name="${groupName}"]`)
            .forEach((input) => {
              input.nextElementSibling.classList.toggle(
                "selected",
                input.checked
              );
            });
        });
      });
    }

    // Render both theory and lab teacher lists
    if (course.theoryTeachers?.length) {
      renderTeacherOptions(theoryContainer, "theory", course.theoryTeachers);
    }
    if (course.labTeachers?.length) {
      renderTeacherOptions(labContainer, "lab", course.labTeachers);
    }
  });

  teacherSection.classList.remove("hidden");
}

// ‚úÖ Generate Timetable based on selected teachers and slots
function generateTimetable() {
  document.querySelectorAll(".course-slot").forEach((el) => el.remove());
  conflictWarnings.innerHTML = "";

  const conflicts = new Set();
  const timeMap = {};
  const labOnlyTimes = unifiedTimes
    .map((u, i) => (u.labOnly ? i : -1))
    .filter((i) => i !== -1);

  // Map: theory index <-> unifiedTimes index
  const theoryToUnifiedIndex = {};
  const unifiedToTheoryIndex = {};
  let theoryRow = 0;
  unifiedTimes.forEach((u, i) => {
    if (!u.labOnly) {
      theoryToUnifiedIndex[theoryRow] = i;
      unifiedToTheoryIndex[i] = theoryRow;
      theoryRow++;
    }
  });

  // Auto-select teachers if not chosen
  selections.courses.forEach((courseCode) => {
    const selected = selections.teachers[courseCode] || {};
    const course = courseData[courseCode];

    ["theory", "lab"].forEach((type) => {
      if (selected[type]) return;

      const candidates =
        (type === "theory" ? course.theoryTeachers : course.labTeachers) || [];
      let bestChoice = null;

      for (const teacher of candidates) {
        let valid = true;

        for (const slotCode of teacher.slots) {
          for (const day of ["TUE", "WED", "THU", "FRI", "SAT"]) {
            const theory = slotStructure[day]?.theorySlots || [];
            const lab = slotStructure[day]?.labSlots || [];

            for (let i = 0; i < unifiedTimes.length; i++) {
              const tIndex = unifiedToTheoryIndex[i];
              const theoryGroup =
                tIndex !== undefined ? theory[tIndex] || [] : [];
              const labGroup = lab[i] || [];

              const slots = [...theoryGroup, ...labGroup].flatMap((s) =>
                s.split(",").map((x) => x.trim())
              );

              if (slots.includes(slotCode)) {
                if (type === "theory" && unifiedTimes[i].labOnly) {
                  valid = false;
                  break;
                }
                const key = `${day}|${i}`;
                if (timeMap[key]?.some((x) => x.slotCode === slotCode)) {
                  valid = false;
                  break;
                }
              }
            }
            if (!valid) break;
          }
          if (!valid) break;
        }

        if (valid) {
          bestChoice = teacher;
          break;
        }
      }

      if (bestChoice) {
        if (!selections.teachers[courseCode])
          selections.teachers[courseCode] = {};
        selections.teachers[courseCode][type] = {
          name: bestChoice.name,
          slots: [...bestChoice.slots],
        };
      }
    });
  });

  // Place teacher slots into the timetable
  selections.courses.forEach((courseCode) => {
    const selected = selections.teachers[courseCode];
    if (!selected) return;

    ["theory", "lab"].forEach((type) => {
      const teacher = selected[type];
      if (!teacher?.slots) return;

      teacher.slots.forEach((slotCode) => {
        for (const day of ["TUE", "WED", "THU", "FRI", "SAT"]) {
          const dayIndex = ["TUE", "WED", "THU", "FRI", "SAT"].indexOf(day);
          const theory = slotStructure[day]?.theorySlots || [];
          const lab = slotStructure[day]?.labSlots || [];

          for (let i = 0; i < unifiedTimes.length; i++) {
            const tIndex = unifiedToTheoryIndex[i];
            const theoryGroup =
              tIndex !== undefined ? theory[tIndex] || [] : [];
            const labGroup = lab[i] || [];

            const slots = [...theoryGroup, ...labGroup].flatMap((s) =>
              s.split(",").map((x) => x.trim())
            );
            if (!slots.includes(slotCode)) continue;

            if (type === "theory" && unifiedTimes[i].labOnly) {
              const warning = document.createElement("div");
              warning.className = "conflict-warning";
              warning.innerHTML = `<i class="fas fa-exclamation-triangle"></i> Cannot place theory slot for ${courseCode} in lab-only time ${unifiedTimes[i].time}`;
              conflictWarnings.appendChild(warning);
              continue;
            }

            const timeKey = `${day}|${i}`;
            if (!timeMap[timeKey]) timeMap[timeKey] = [];
            timeMap[timeKey].push({
              slotCode,
              courseCode,
              teacherName: teacher.name,
              isLab: type === "lab",
            });

            if (timeMap[timeKey].length > 1) {
              conflicts.add(timeKey);
            }

            const row = i + 1;
            const col = dayIndex + 1;
            const cellIndex = row * 6 + col;

            const cell = timetableGrid.children[cellIndex];
            const div = document.createElement("div");
            div.className = `course-slot ${
              type === "lab" ? "lab-slot" : "theory-slot"
            }`;
            div.textContent = courseCode;
            div.title = `${courseData[courseCode].name}\nTeacher: ${teacher.name}`;
            if (timeMap[timeKey].length > 1) div.classList.add("conflict-slot");
            cell.appendChild(div);
          }
        }
      });
    });
  });

  // Display conflict warnings
  if (conflicts.size > 0) {
    conflicts.forEach((key) => {
      const [day, index] = key.split("|");
      const overlapping = timeMap[key].map((x) => x.courseCode);
      const warning = document.createElement("div");
      warning.className = "conflict-warning";
      warning.innerHTML = `<i class="fas fa-exclamation-triangle"></i> Time Conflict on ${day} ${
        unifiedTimes[index].time
      }: ${[...new Set(overlapping)].join(", ")}`;
      conflictWarnings.appendChild(warning);
    });
  } else {
    const msg = document.createElement("div");
    msg.className = "conflict-warning";
    msg.textContent = "No conflicts detected in your timetable!";
    conflictWarnings.appendChild(msg);
  }

  timetableDisplay.classList.remove("hidden");

  // ‚úÖ Display total credits
  let totalCredits = 0;
  const creditSet = new Set(); // avoid double-counting

  selections.courses.forEach((code) => {
    if (courseData[code] && !creditSet.has(code)) {
      totalCredits += courseData[code].credits || 0;
      creditSet.add(code);
    }
  });

  const creditBar = document.getElementById("total-credits");
  if (creditBar) {
    creditBar.textContent = `Total Credits: ${totalCredits}`;
  } else {
    const div = document.createElement("div");
    div.id = "total-credits";
    div.className = "total-credits";
    div.textContent = `Total Credits: ${totalCredits}`;
    conflictWarnings.insertAdjacentElement("beforebegin", div);
  }
}

// ‚úÖ Save/load selection
function saveSelection() {
  try {
    localStorage.setItem("timetableSelection", JSON.stringify(selections));
    alert("Selection saved!");
  } catch (e) {
    alert("Save failed: " + e.message);
  }
}

function loadSelection() {
  try {
    const saved = JSON.parse(localStorage.getItem("timetableSelection"));
    if (!saved?.courses || !saved?.teachers) throw new Error("Invalid format");
    if (
      saved.version !== selections.version &&
      !confirm("Version mismatch. Load anyway?")
    )
      return;

    selections.courses = saved.courses;
    selections.teachers = saved.teachers;

    Array.from(courseSelect.options).forEach((opt) => {
      opt.selected = selections.courses.includes(opt.value.split(" - ")[0]);
    });

    showTeacherOptions();
    alert("Selection loaded!");
  } catch (e) {
    alert("Load failed: " + e.message);
  }
}

// ‚úÖ Export timetable
async function exportAsPDF() {
  try {
    const { jsPDF } = window.jspdf;
    const doc = new jsPDF({ orientation: "landscape", unit: "mm" });
    doc.setFontSize(20);
    doc.text("Timetable", 105, 15, { align: "center" });

    const timetableElement = document.querySelector(".timetable-container");
    const canvas = await html2canvas(timetableElement, { scale: 2 });
    const imgData = canvas.toDataURL("image/png");
    const imgWidth = 280;
    const imgHeight = (canvas.height * imgWidth) / canvas.width;

    doc.addImage(imgData, "PNG", 10, 20, imgWidth, imgHeight);
    doc.save("timetable.pdf");
  } catch (e) {
    alert("Export failed: " + e.message);
  }
}

async function exportAsImage() {
  try {
    const timetableElement = document.querySelector(".timetable-container");
    const canvas = await html2canvas(timetableElement, { scale: 2 });
    const link = document.createElement("a");
    link.download = "timetable.png";
    link.href = canvas.toDataURL("image/png");
    link.click();
  } catch (e) {
    alert("Image export failed: " + e.message);
  }
}

// ‚úÖ Reset selections
function resetSelections() {
  courseSelect.selectedIndex = -1;
  teacherContainer.innerHTML = "";
  selections.courses = [];
  selections.teachers = {};
  teacherSection.classList.add("hidden");
  timetableDisplay.classList.add("hidden");
  document.querySelectorAll(".course-slot").forEach((el) => el.remove());
  conflictWarnings.innerHTML = "";
}

// ‚úÖ Event listners
document.addEventListener("DOMContentLoaded", () => {
  initializeTimetable();

  confirmBtn.addEventListener("click", showTeacherOptions);
  backBtn.addEventListener("click", () =>
    teacherSection.classList.add("hidden")
  );
  generateBtn.addEventListener("click", generateTimetable);
  resetBtn.addEventListener("click", resetSelections);
  saveBtn.addEventListener("click", saveSelection);
  loadBtn.addEventListener("click", loadSelection);
  exportPdfBtn.addEventListener("click", exportAsPDF);
  exportImageBtn.addEventListener("click", exportAsImage);
});

console.log(generateBtn); // should not be null
console.log(window.getComputedStyle(generateBtn).display);
console.log("Children in timetableGrid:", timetableGrid.children.length);
